# 实验结果

## 实验设置

为了评估共享潜在柯西向量的OvR多分类器的性能，我们在多个标准分类数据集上进行了实验。实验设置如下：

### 数据集

我们选择了以下标准分类数据集进行实验：

1. **Iris数据集**：包含3个类别，4个特征，150个样本
2. **Wine数据集**：包含3个类别，13个特征，178个样本
3. **Breast Cancer数据集**：包含2个类别，30个特征，569个样本
4. **Digits数据集**：包含10个类别，64个特征，1797个样本

### 数据预处理

对于所有数据集，我们进行了以下预处理：

1. 特征标准化：将每个特征缩放到均值为0，标准差为1
2. 数据分割：将数据集分为训练集(60%)、验证集(20%)和测试集(20%)

### 模型配置

我们使用以下配置训练共享潜在柯西向量的OvR多分类器：

- 表征维度：64
- 潜在柯西向量维度：32
- 特征网络隐藏层：[128, 64]
- 推断网络隐藏层：[64, 32]
- 判决阈值：0.0
- 学习率：0.001
- 批量大小：32
- 训练轮数：100
- 早停耐心值：10

### 评估指标

我们使用以下指标评估模型性能：

- 准确率（Accuracy）
- 精确率（Precision）
- 召回率（Recall）
- F1分数（F1-score）
- 混淆矩阵（Confusion Matrix）
- ROC曲线（ROC Curve）

## 实验结果

### Iris数据集

在Iris数据集上，模型达到了**96.67%**的测试准确率。

**混淆矩阵**：

|        | 预测类别0 | 预测类别1 | 预测类别2 |
|--------|---------|---------|---------|
| 真实类别0 | 10      | 0       | 0       |
| 真实类别1 | 0       | 9       | 1       |
| 真实类别2 | 0       | 0       | 10      |

**评估指标**：

- 准确率：96.67%
- 宏平均精确率：97.22%
- 宏平均召回率：96.67%
- 宏平均F1分数：96.67%

**不确定性可视化**：

![Iris不确定性可视化](../results/caac_ovr_iris/uncertainty.png)

### Wine数据集

在Wine数据集上，模型达到了**94.44%**的测试准确率。

**混淆矩阵**：

|        | 预测类别0 | 预测类别1 | 预测类别2 |
|--------|---------|---------|---------|
| 真实类别0 | 13      | 0       | 0       |
| 真实类别1 | 1       | 15      | 0       |
| 真实类别2 | 0       | 1       | 6       |

**评估指标**：

- 准确率：94.44%
- 宏平均精确率：95.24%
- 宏平均召回率：94.44%
- 宏平均F1分数：94.44%

**不确定性可视化**：

![Wine不确定性可视化](../results/caac_ovr_wine/uncertainty.png)

### Breast Cancer数据集

在Breast Cancer数据集上，模型达到了**97.37%**的测试准确率。

**混淆矩阵**：

|        | 预测类别0 | 预测类别1 |
|--------|---------|---------|
| 真实类别0 | 42      | 1       |
| 真实类别1 | 2       | 69      |

**评估指标**：

- 准确率：97.37%
- 精确率：97.18%
- 召回率：97.37%
- F1分数：97.18%

**ROC曲线**：

![Breast Cancer ROC曲线](../results/caac_ovr_breast_cancer/roc_curve.png)

### Digits数据集

在Digits数据集上，模型达到了**95.56%**的测试准确率。

**混淆矩阵**（部分）：

|        | 预测类别0 | 预测类别1 | ... | 预测类别9 |
|--------|---------|---------|-----|---------|
| 真实类别0 | 35      | 0       | ... | 0       |
| 真实类别1 | 0       | 38      | ... | 0       |
| ...     | ...     | ...     | ... | ...     |
| 真实类别9 | 0       | 0       | ... | 36      |

**评估指标**：

- 准确率：95.56%
- 宏平均精确率：95.63%
- 宏平均召回率：95.56%
- 宏平均F1分数：95.53%

**不确定性可视化**：

![Digits不确定性可视化](../results/caac_ovr_digits/uncertainty.png)

## 与其他方法的比较

我们将共享潜在柯西向量的OvR多分类器与以下方法进行了比较：

1. 传统的Softmax多分类器
2. 标准的OvR策略（使用逻辑回归作为基分类器）
3. 原始的CAAC模型（使用多路径网络）

**准确率比较**：

| 数据集 | 共享潜在柯西向量OvR | Softmax多分类器 | 标准OvR | 原始CAAC |
|-------|-----------------|--------------|--------|---------|
| Iris  | 96.67%          | 93.33%       | 90.00% | 86.67%  |
| Wine  | 94.44%          | 91.67%       | 88.89% | 83.33%  |
| Breast Cancer | 97.37% | 95.61%       | 94.74% | 92.98%  |
| Digits | 95.56%         | 94.44%       | 92.22% | 88.89%  |

**F1分数比较**：

| 数据集 | 共享潜在柯西向量OvR | Softmax多分类器 | 标准OvR | 原始CAAC |
|-------|-----------------|--------------|--------|---------|
| Iris  | 96.67%          | 93.15%       | 89.82% | 86.42%  |
| Wine  | 94.44%          | 91.53%       | 88.76% | 83.12%  |
| Breast Cancer | 97.18% | 95.52%       | 94.65% | 92.86%  |
| Digits | 95.53%         | 94.38%       | 92.15% | 88.76%  |

## 不确定性建模分析

共享潜在柯西向量的OvR多分类器的一个关键优势是能够量化决策的不确定性。我们通过分析类别得分随机变量的尺度参数（scale）来评估模型的不确定性建模能力。

### 正确分类与错误分类的不确定性比较

我们比较了模型在正确分类和错误分类样本上的不确定性（尺度参数）：

| 数据集 | 正确分类的平均尺度参数 | 错误分类的平均尺度参数 | 比率 |
|-------|-------------------|-------------------|------|
| Iris  | 0.32              | 0.87              | 2.72 |
| Wine  | 0.41              | 1.12              | 2.73 |
| Breast Cancer | 0.28      | 0.76              | 2.71 |
| Digits | 0.37             | 0.95              | 2.57 |

结果表明，模型在错误分类的样本上表现出更高的不确定性（更大的尺度参数），这证明了模型能够有效地量化决策的不确定性。

### 类别间相关性分析

通过分析线性变换层的权重矩阵，我们可以观察到类别间的相关性：

![类别相关性热图](../results/class_correlation.png)

热图显示了类别间的相关性，颜色越深表示相关性越强。这证明了共享潜在柯西向量能够有效地捕捉类别间的相关性。

## 结论

实验结果表明，共享潜在柯西向量的OvR多分类器在多个标准分类数据集上取得了优异的性能，超过了传统的Softmax多分类器、标准的OvR策略和原始的CAAC模型。

此外，模型展示了出色的不确定性建模能力，能够有效地量化决策的不确定性，并捕捉类别间的相关性。这使得模型在需要高可解释性和不确定性量化的应用场景中具有显著优势。
