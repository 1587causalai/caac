# 理论设计

## 1. 背景与动机

CAAC-SPSFT（Cauchy Abduction Action Classification with Stochastic Pathway Selection and Fixed Thresholds）是对CAAR（Cauchy Abduction Action Regression）回归模型的扩展，旨在将柯西分布的因果推断框架应用于分类任务。

在许多实际应用场景中，我们需要处理的是分类问题而非回归问题，例如疾病诊断、风险评估等。同时，这些应用场景通常要求模型具有良好的可解释性和对异常值的鲁棒性。CAAC-SPSFT正是为了满足这些需求而设计的。

## 2. 核心理念

CAAC-SPSFT的核心理念是：**保持因果表征的生成过程，但通过固定阈值机制将连续的潜在表征映射到离散的类别标签**。

具体来说，CAAC-SPSFT包含以下关键组件：

### 2.1 因果表征生成

与CAAR一样，CAAC-SPSFT使用柯西分布来建模潜在的因果表征。柯西分布的重尾特性使得模型对异常值具有天然的鲁棒性。

因果表征的生成过程如下：

1. 输入特征 x 通过特征网络（FeatureNetwork）转换为高级表征 h(x)
2. 高级表征 h(x) 通过推断网络（AbductionNetwork）生成柯西分布的参数 (μ_C, γ_C)
3. 这些参数定义了一个柯西分布，表示潜在的因果状态

### 2.2 多路径混合策略

CAAC-SPSFT引入了多路径网络（PathwayNetwork），包含K条并行的"解读路径"，每条路径有自己的线性变换参数。这种设计增强了模型的表达能力，同时保持了可解释性。

每条路径j对应一组线性变换参数 (w_j, b_j)，将因果表征参数 (μ_C, γ_C) 转换为路径特定的柯西得分参数 (μ_j, γ_j)。

### 2.3 固定阈值机制

CAAC-SPSFT的核心创新是引入了全局固定的分类阈值θ*，确保机制不变性。对于二分类问题，只需要一个阈值；对于多分类问题，需要C-1个有序阈值（其中C是类别数）。

这些阈值是模型的全局参数，与输入无关，确保了因果表征到分类结果的映射机制是固定的。

### 2.4 分类概率计算

基于柯西CDF和固定阈值，CAAC-SPSFT计算每条路径的分类概率，然后通过路径选择概率π_j进行加权平均。

对于二分类问题，类别1的概率为：

P(Y=1|M=j,x) = F_j(θ*) = 0.5 + (1/π) * arctan((θ* - μ_j) / γ_j)

类别2的概率为：

P(Y=2|M=j,x) = 1 - F_j(θ*) = 0.5 - (1/π) * arctan((θ* - μ_j) / γ_j)

最终的分类概率是所有路径的加权平均：

P(Y=c|x) = Σ_j π_j * P(Y=c|M=j,x)

## 3. 数学推导

### 3.1 柯西分布

柯西分布的概率密度函数（PDF）为：

f(x; μ, γ) = 1 / (π * γ * [1 + ((x - μ) / γ)²])

其中，μ是位置参数，γ是尺度参数。

柯西分布的累积分布函数（CDF）为：

F(x; μ, γ) = 0.5 + (1/π) * arctan((x - μ) / γ)

### 3.2 负对数似然损失

对于二分类问题，CAAC-SPSFT使用负对数似然（NLL）作为损失函数：

L(θ) = -Σ_i log P(Y=y_i|x_i)

其中，y_i是第i个样本的真实标签，P(Y=y_i|x_i)是模型预测的概率。

## 4. 与CAAR的关系

CAAC-SPSFT与CAAR共享相同的因果表征生成机制，但在输出层有所不同：

- CAAR直接从因果表征生成连续的回归输出
- CAAC-SPSFT通过固定阈值机制将因果表征映射到离散的类别标签

这种设计使得CAAC-SPSFT保留了CAAR的优点（如对异常值的鲁棒性和可解释性），同时扩展到分类任务。

## 5. 机制不变性

CAAC-SPSFT的一个重要特性是机制不变性，即输入数据仅影响因果表征生成，而因果表征到分类结果的映射机制是固定的。

这种设计有几个优点：

1. 提高模型的泛化能力
2. 增强模型的可解释性
3. 使模型更符合因果推断的哲学原则

在实践中，机制不变性通过固定阈值θ*来实现，这些阈值是模型的全局参数，与输入无关。
