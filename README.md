# CAAC Project - Shared Latent Cauchy Vector OvR Classifier

åŸºäºå…±äº«æ½œåœ¨æŸ¯è¥¿å‘é‡çš„ One-vs-Rest (OvR) å¤šåˆ†ç±»å™¨é¡¹ç›®ã€‚

## é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®å®ç°äº†ä¸€ç§æ–°é¢–çš„å¤šåˆ†ç±»å™¨æ¶æ„â€”â€”**åŸºäºå…±äº«æ½œåœ¨æŸ¯è¥¿å‘é‡çš„ One-vs-Rest (OvR) åˆ†ç±»å™¨**ã€‚è¯¥æ¨¡å‹ç»“åˆäº† OvR ç­–ç•¥çš„æ•ˆç‡å’Œå¯æ‰©å±•æ€§ï¼Œä»¥åŠæŸ¯è¥¿åˆ†å¸ƒå¯¹å†³ç­–ä¸ç¡®å®šæ€§çš„æ˜¾å¼å»ºæ¨¡èƒ½åŠ›ï¼Œå¹¶å¼•å…¥å…±äº«çš„æ½œåœ¨éšæœºå‘é‡æ¥éšå¼æ•æ‰ç±»åˆ«é—´çš„ç›¸å…³æ€§ã€‚

## æ ¸å¿ƒç‰¹æ€§

- ğŸš€ **é«˜æ•ˆçš„ OvR ç­–ç•¥**ï¼šå¯å¹¶è¡Œè®­ç»ƒï¼Œæ˜“äºæ‰©å±•åˆ°å¤§é‡ç±»åˆ«
- ğŸ¯ **ä¸ç¡®å®šæ€§é‡åŒ–**ï¼šé€šè¿‡æŸ¯è¥¿åˆ†å¸ƒå‚æ•°é‡åŒ–å†³ç­–çš„"ä¸­å¿ƒ"å’Œ"æ¨¡ç³Šåº¦"
- ğŸ”— **ç±»åˆ«ç›¸å…³æ€§å»ºæ¨¡**ï¼šé€šè¿‡å…±äº«æ½œåœ¨å‘é‡æ•æ‰ç±»åˆ«é—´çš„å†…åœ¨è”ç³»
- ğŸ“Š **å®Œæ•´çš„å®éªŒæ¡†æ¶**ï¼šåŒ…å«è®­ç»ƒã€è¯„ä¼°ã€å¯è§†åŒ–çš„å®Œæ•´æµç¨‹

## é¡¹ç›®ç»“æ„

```
caac_project/
â”œâ”€â”€ src/                          # æºä»£ç 
â”‚   â”œâ”€â”€ models/                   # æ¨¡å‹å®ç°
â”‚   â”‚   â”œâ”€â”€ caac_ovr_model.py    # ä¸»æ¨¡å‹ç±»
â”‚   â”‚   â”œâ”€â”€ unified_network.py    # ç»Ÿä¸€ç½‘ç»œæ¶æ„
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ experiments/              # å®éªŒè„šæœ¬
â”‚   â”‚   â”œâ”€â”€ run_experiments.py    # å•ä¸ªå®éªŒè¿è¡Œ
â”‚   â”‚   â””â”€â”€ model_evaluator.py    # æ¨¡å‹è¯„ä¼°å™¨
â”‚   â””â”€â”€ data/                     # æ•°æ®å¤„ç†æ¨¡å—
â”œâ”€â”€ docs/                         # æ–‡æ¡£
â”‚   â”œâ”€â”€ motivation.md            # ç†è®ºåŠ¨æœº
â”‚   â””â”€â”€ experiments.md           # å®éªŒç»“æœ
â”œâ”€â”€ results/                      # å®éªŒç»“æœ
â”œâ”€â”€ run_all_experiments.py       # æ‰¹é‡è¿è¡Œæ‰€æœ‰å®éªŒ
â”œâ”€â”€ generate_experiment_report.py # ç”Ÿæˆå®éªŒæŠ¥å‘Š
â””â”€â”€ README.md                    # é¡¹ç›®è¯´æ˜
```

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.7+
- PyTorch
- scikit-learn
- matplotlib
- pandas
- numpy
- seaborn

### å®‰è£…ä¾èµ–

```bash
# æ¨èä½¿ç”¨condaç¯å¢ƒ
conda activate base
pip install torch scikit-learn matplotlib pandas numpy seaborn
```

### è¿è¡Œå®éªŒ

#### ğŸš€ æ ‡ç­¾å™ªå£°é²æ£’æ€§æµ‹è¯• (æ¨è)

**æ–°å¢ï¼šåŸºäºæ‰©å±•æ•°æ®é›†çš„é²æ£’æ€§æµ‹è¯•**

æœ¬é¡¹ç›®ç°åœ¨æ”¯æŒåœ¨**10ä¸ªå¤šæ ·åŒ–æ•°æ®é›†**ä¸Šè¿›è¡Œæ ‡ç­¾å™ªå£°é²æ£’æ€§æµ‹è¯•ï¼Œæ€»è®¡74,000+æ ·æœ¬ï¼

##### å¿«é€Ÿé€‰æ‹©æµ‹è¯•æ¨¡å¼ï¼š

```bash
# 1. å¿«é€ŸéªŒè¯ (3-5åˆ†é’Ÿ) - 4ä¸ªå°æ•°æ®é›†
python run_quick_robustness_test.py

# 2. æ ‡å‡†æµ‹è¯• (15-25åˆ†é’Ÿ) - 8ä¸ªæ•°æ®é›† (æ¨è)
python run_standard_robustness_test.py

# 3. å®Œæ•´äº¤äº’å¼æµ‹è¯• (è‡ªé€‰æ•°æ®é›†)
python compare_methods_outlier_robustness.py
```

##### æ”¯æŒçš„æ•°æ®é›†ï¼š

| æ•°æ®é›† | æ ·æœ¬æ•° | ç‰¹å¾æ•° | ç±»åˆ«æ•° | è§„æ¨¡ | ç‰¹ç‚¹ |
|-------|-------|-------|-------|------|-----|
| Iris | 150 | 4 | 3 | small | ç»å…¸å¹³è¡¡æ•°æ®é›† |
| Wine | 178 | 13 | 3 | small | è½»å¾®ä¸å¹³è¡¡ |
| Breast Cancer | 569 | 30 | 2 | small | åŒ»ç–—è¯Šæ–­æ•°æ® |
| Optical Digits | 1,797 | 64 | 10 | small | æ‰‹å†™æ•°å­—è¯†åˆ« |
| Digits | 1,797 | 64 | 10 | medium | æ•°å­—è¯†åˆ« |
| Synthetic Imbalanced | 5,000 | 20 | 5 | medium | åˆæˆä¸å¹³è¡¡æ•°æ® |
| Forest Covertype | 10,000 | 54 | 7 | medium | æ£®æ—è¦†ç›–é¢„æµ‹ |
| Letter Recognition | 20,000 | 16 | 26 | medium | 26ç±»å­—æ¯è¯†åˆ« |
| MNIST | 15,000 | 784 | 10 | large | æ‰‹å†™æ•°å­—å›¾åƒ |
| Fashion-MNIST | 20,000 | 784 | 10 | large | æœè£…å›¾åƒåˆ†ç±» |

##### æµ‹è¯•é…ç½®ï¼š

- **å™ªå£°æ°´å¹³**: 0%, 5%, 10%, 15%, 20%
- **æ•°æ®åˆ†å‰²**: 70% train / 15% val / 15% test
- **æ–¹æ³•å¯¹æ¯”**: CAAC(Cauchy), CAAC(Gaussian), MLP(Softmax), MLP(OvR), MLP(Hinge)
- **è¾“å‡º**: è¯¦ç»†æŠ¥å‘Šã€é²æ£’æ€§æ›²çº¿ã€çƒ­åŠ›å›¾ã€åŸå§‹æ•°æ®

#### ğŸ”¬ åŸºç¡€æ€§èƒ½æµ‹è¯•

##### 1. è¿è¡Œå•ä¸ªæ•°æ®é›†å®éªŒ

```bash
# è¿›å…¥å®éªŒç›®å½•
cd src/experiments

# è¿è¡Œ Iris æ•°æ®é›†å®éªŒ
python run_experiments.py --dataset iris

# è¿è¡Œ Wine æ•°æ®é›†å®éªŒ
python run_experiments.py --dataset wine

# è¿è¡Œ Breast Cancer æ•°æ®é›†å®éªŒ
python run_experiments.py --dataset breast_cancer

# è¿è¡Œ Digits æ•°æ®é›†å®éªŒ
python run_experiments.py --dataset digits
```

##### 2. æ‰¹é‡è¿è¡Œæ‰€æœ‰å®éªŒ

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
python run_all_experiments.py

# åŒ…å«æ–¹æ³•æ¯”è¾ƒæŠ¥å‘Š
python run_all_experiments.py --comparison
```

##### 3. ç”Ÿæˆå®éªŒæŠ¥å‘Š

```bash
# åˆ†æå·²æœ‰å®éªŒç»“æœå¹¶ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š
python generate_experiment_report.py

# æŒ‡å®šç»“æœç›®å½•
python generate_experiment_report.py --results_dir results --output_dir reports
```

## å®éªŒç»“æœ

### ğŸ¯ æ ‡ç­¾å™ªå£°é²æ£’æ€§æµ‹è¯•ç»“æœ

åŸºäºæ‰©å±•çš„10ä¸ªæ•°æ®é›†çš„é²æ£’æ€§æµ‹è¯•è¡¨æ˜ï¼Œ**CAAC (Cauchy) æ–¹æ³•åœ¨æ ‡ç­¾å™ªå£°ç¯å¢ƒä¸‹è¡¨ç°æœ€ä½³**ï¼š

#### é²æ£’æ€§æ’å (ç»¼åˆ74,000+æ ·æœ¬):

| æ’å | æ–¹æ³• | é²æ£’æ€§å¾—åˆ† | åŸºçº¿å‡†ç¡®ç‡ | æ€§èƒ½è¡°å‡ | ç‰¹ç‚¹ |
|-----|------|-----------|-----------|---------|------|
| ğŸ¥‡ | **CAAC OvR (Cauchy)** | **0.9539** | 0.9623 | **1.7%** | æœ€ç¨³å®š |
| ğŸ¥ˆ | CAAC OvR (Gaussian) | 0.9378 | 0.9538 | 2.7% | æ¬¡ä½³é²æ£’æ€§ |
| ğŸ¥‰ | MLP (OvR Cross Entropy) | 0.9376 | 0.9661 | 4.0% | ä¼ ç»Ÿæ–¹æ³•æœ€ä½³ |
| 4 | MLP (Crammer & Singer Hinge) | 0.9368 | 0.9269 | 2.4% | é“°é“¾æŸå¤± |
| 5 | MLP (Softmax) | 0.9331 | 0.9615 | **7.0%** | è¡°å‡æœ€å¤§ |

#### å…³é”®å‘ç°ï¼š

- âœ… **CAAC (Cauchy) æœ€é²æ£’**: åœ¨20%æ ‡ç­¾å™ªå£°ä¸‹ä»…è¡°å‡1.7%
- âœ… **æŸ¯è¥¿åˆ†å¸ƒä¼˜äºé«˜æ–¯åˆ†å¸ƒ**: é²æ£’æ€§å¾—åˆ†é«˜1.6%
- âœ… **CAACæ–¹æ³•æ•´ä½“ä¼˜ç§€**: åœ¨5ç§æ–¹æ³•ä¸­å æ®å‰2å

### ğŸ“Š åŸºç¡€æ€§èƒ½æµ‹è¯•ç»“æœ

æ¨¡å‹åœ¨å››ä¸ªæ ‡å‡†åˆ†ç±»æ•°æ®é›†ä¸Šçš„è¡¨ç°ï¼š

| Dataset | Accuracy | F1 Score (Macro) | Training Time |
|---------|----------|------------------|---------------|
| Iris | 96.67% | 96.67% | ~0.1s |
| Wine | 94.44% | 94.44% | ~0.1s |
| Breast Cancer | 97.37% | 97.18% | ~0.2s |
| Digits | 95.56% | 95.53% | ~0.5s |

#### ä¸å…¶ä»–æ–¹æ³•çš„æ¯”è¾ƒ

| Dataset | æœ¬æ–¹æ³• | Softmax | æ ‡å‡†OvR | åŸå§‹CAAC |
|---------|--------|---------|---------|----------|
| Iris | **96.67%** | 93.33% | 90.00% | 86.67% |
| Wine | **94.44%** | 91.67% | 88.89% | 83.33% |
| Breast Cancer | **97.37%** | 95.61% | 94.74% | 92.98% |
| Digits | **95.56%** | 94.44% | 92.22% | 88.89% |

## å®éªŒè¾“å‡º

æ¯æ¬¡å®éªŒä¼šåœ¨ `results/` ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªåŒ…å«ä»¥ä¸‹å†…å®¹çš„æ–‡ä»¶å¤¹ï¼š

- `experiment_results.json` - è¯¦ç»†çš„å®éªŒç»“æœå’Œé…ç½®
- `training_history.json` - è®­ç»ƒå†å²æ•°æ®
- `confusion_matrix.png` - æ··æ·†çŸ©é˜µå¯è§†åŒ–
- `roc_curve.png` - ROCæ›²çº¿å›¾
- `uncertainty.png` - ä¸ç¡®å®šæ€§åˆ†æå›¾
- `training_history.png` - è®­ç»ƒè¿‡ç¨‹å¯è§†åŒ–

## æ¨¡å‹é…ç½®

ä¸»è¦çš„æ¨¡å‹å‚æ•°ï¼š

- **è¡¨å¾ç»´åº¦ (representation_dim)**: 64
- **æ½œåœ¨æŸ¯è¥¿å‘é‡ç»´åº¦ (latent_dim)**: 32
- **ç‰¹å¾ç½‘ç»œéšè—å±‚**: [128, 64]
- **æ¨æ–­ç½‘ç»œéšè—å±‚**: [64, 32]
- **åˆ¤å†³é˜ˆå€¼**: 0.0
- **å­¦ä¹ ç‡**: 0.001
- **æ‰¹é‡å¤§å°**: 32
- **è®­ç»ƒè½®æ•°**: 100ï¼ˆå«æ—©åœæœºåˆ¶ï¼‰

## ç†è®ºåŸºç¡€

è¯¦ç»†çš„ç†è®ºåŠ¨æœºå’Œæ•°å­¦åŸç†è¯·å‚è§ [`docs/motivation.md`](docs/motivation.md)ã€‚

å…³é”®åˆ›æ–°ç‚¹ï¼š
1. **å…±äº«æ½œåœ¨æŸ¯è¥¿å‘é‡**ï¼šé€šè¿‡å­¦ä¹ ä½ç»´æŸ¯è¥¿éšæœºå‘é‡çš„å‚æ•°ï¼Œå†çº¿æ€§å˜æ¢åˆ°å„ç±»åˆ«å¾—åˆ†
2. **OvRç­–ç•¥**ï¼šå°†å¤šåˆ†ç±»é—®é¢˜åˆ†è§£ä¸ºå¤šä¸ªç‹¬ç«‹çš„äºŒåˆ†ç±»é—®é¢˜
3. **ä¸ç¡®å®šæ€§å»ºæ¨¡**ï¼šæŸ¯è¥¿åˆ†å¸ƒçš„ä½ç½®å’Œå°ºåº¦å‚æ•°æä¾›å†³ç­–çš„"ä¸­å¿ƒ"å’Œ"æ¨¡ç³Šåº¦"ä¿¡æ¯

## è´¡çŒ®

æœ¬é¡¹ç›®çš„ä¸»è¦è´¡çŒ®ï¼š

1. æå‡ºäº†åŸºäºå…±äº«æ½œåœ¨æŸ¯è¥¿å‘é‡çš„æ–°å‹OvRå¤šåˆ†ç±»å™¨æ¶æ„
2. å®ç°äº†å®Œæ•´çš„è®­ç»ƒã€è¯„ä¼°å’Œå¯è§†åŒ–æ¡†æ¶
3. åœ¨å¤šä¸ªæ ‡å‡†æ•°æ®é›†ä¸ŠéªŒè¯äº†æ–¹æ³•çš„æœ‰æ•ˆæ€§
4. æä¾›äº†è¯¦ç»†çš„ä¸ç¡®å®šæ€§åˆ†æå’Œå¯è§£é‡Šæ€§ç ”ç©¶

## ğŸš€ å¿«é€Ÿå‘½ä»¤å‚è€ƒ

### æŸ¥çœ‹æ‰€æœ‰æµ‹è¯•é€‰é¡¹
```bash
python show_test_options.py  # æ˜¾ç¤ºè¯¦ç»†çš„æµ‹è¯•é€‰é¡¹å’Œä½¿ç”¨è¯´æ˜
```

### é²æ£’æ€§æµ‹è¯• (æ¨è)
```bash
# å¿«é€ŸéªŒè¯ (5åˆ†é’Ÿ)
python run_quick_robustness_test.py

# æ ‡å‡†æµ‹è¯• (25åˆ†é’Ÿ, æ¨èç”¨äºç ”ç©¶)
python run_standard_robustness_test.py

# äº¤äº’å¼è‡ªå®šä¹‰æµ‹è¯•
python compare_methods_outlier_robustness.py
```

### æ•°æ®é›†å’Œç¯å¢ƒæµ‹è¯•
```bash
# æµ‹è¯•æ•°æ®é›†åŠ è½½
python test_new_datasets.py

# æ£€æŸ¥ç¯å¢ƒä¾èµ–
conda activate base
pip install torch scikit-learn matplotlib pandas numpy seaborn
```

### åŸºç¡€æ€§èƒ½æµ‹è¯•
```bash
# æ‰¹é‡åŸºç¡€æµ‹è¯•
python run_all_experiments.py --comparison

# å•æ•°æ®é›†æµ‹è¯•
cd src/experiments
python run_experiments.py --dataset iris
```

## ğŸ“ é‡è¦æ–‡ä»¶è¯´æ˜

- `compare_methods_outlier_robustness.py` - ä¸»è¦çš„é²æ£’æ€§æµ‹è¯•è„šæœ¬
- `run_standard_robustness_test.py` - ä¸€é”®æ ‡å‡†æµ‹è¯•
- `run_quick_robustness_test.py` - ä¸€é”®å¿«é€Ÿæµ‹è¯•  
- `show_test_options.py` - æµ‹è¯•é€‰é¡¹æ¦‚è§ˆ
- `test_new_datasets.py` - æ•°æ®é›†åŠŸèƒ½æµ‹è¯•
- `results/` - æ‰€æœ‰å®éªŒç»“æœå’ŒæŠ¥å‘Š
- `src/` - æºä»£ç å’Œæ¨¡å‹å®ç°

## è®¸å¯è¯

MIT License

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æäº¤ Issue æˆ–è”ç³»é¡¹ç›®ç»´æŠ¤è€…ã€‚ 